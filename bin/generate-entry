#!/usr/bin/env node

var fs = require('fs')
var Path = require('path')
var program = require('commander')
var NonNodeFacadeGenerator = require('../dist/non-node-facade-generator')


function main() {

    program
        .arguments('<facade-file>')
        .arguments('<domain-directory>')
        .option('-o, --outfile', 'out file = (facadeDir/entry.js)')
        .option('-c, --compiler <compiler-module-name>', 'compiler (e.g. babel-register)')
        .parse(process.argv)

    var facadePath = program.args[0]
    var dirname = program.args[1]
    var outfile = program.outfile

    if (!facadePath || !dirname) {
        return program.help()
    }
    if (!outfile) {
        outfile = Path.dirname(facadePath) + '/entry.js'
    }

    if (program.compiler) {
        require(program.compiler)
    }

    new NonNodeFacadeGenerator().generate(facadePath, dirname, outfile)
    console.log(outfile, 'is successfully generated!')
}


if (require.main === module) main()
